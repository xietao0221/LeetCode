public int lastRemaining(int n) {
	int remaining = n;
	int start = 1;
	int step = 2;
	boolean left = true;
	while (remaining > 1) {
		remaining = remaining / 2;
		if (left)
			start = start + step * remaining - step / 2;
		else
			start = start - step * remaining + step / 2;

		step *= 2;
		left = left ? false : true;
	}

	return start;
}